<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0"><channel><title>浩楠的运维笔记</title><link>https://h-haonan.github.io/haonan/</link><description>用心甘情愿的态度，过随遇而安的生活</description><copyright>浩楠的运维笔记</copyright><docs>http://www.rssboard.org/rss-specification</docs><generator>python-feedgen</generator><image><url>https://github.com/H-haonan/H-haonan.github.io/blob/master/img/avatar.png?raw=true</url><title>avatar</title><link>https://h-haonan.github.io/haonan/</link></image><lastBuildDate>Sat, 11 May 2024 08:24:55 +0000</lastBuildDate><managingEditor>浩楠的运维笔记</managingEditor><ttl>60</ttl><webMaster>浩楠的运维笔记</webMaster><item><title>centos版k8s集群遇到证书过期问题</title><link>https://h-haonan.github.io/haonan//post/centos-ban-k8s-ji-qun-yu-dao-zheng-shu-guo-qi-wen-ti.html</link><description>先看是几个节点的集群，需要在每个节点执行以下操作。</description><guid isPermaLink="true">https://h-haonan.github.io/haonan//post/centos-ban-k8s-ji-qun-yu-dao-zheng-shu-guo-qi-wen-ti.html</guid><pubDate>Sat, 11 May 2024 08:24:30 +0000</pubDate></item><item><title>talos修改节点地址方案</title><link>https://h-haonan.github.io/haonan//post/talos-xiu-gai-jie-dian-di-zhi-fang-an.html</link><description>一.先添加新节点地址ip&#13;
talosctl edit mc 修改机器配置，在服务器接口地址那块加上客户现场地址的ip和网关（每台都改）&#13;
 ●addresses:&#13;
   - 172.16.100.151/24  #之前集群地址&#13;
   - 2408:8631:c02:ffa0::151/64 #之前集群地址&#13;
   - 172.16.102.151/24 #需要添加客户现场地址&#13;
   - 2408:8631:c02:ffa2::151/64 #需要添加客户现场地址&#13;
   bond:&#13;
   deviceSelectors:&#13;
   - busPath: "0000:07:00.0"&#13;
   - busPath: "0000:08:00.0"&#13;
   miimon: 10&#13;
   mode: active-backup&#13;
   interface: bond-metallb&#13;
   mtu: 1500&#13;
   routes:&#13;
   - gateway: 172.16.102.1 #需要修改的客户现场网关&#13;
   network:  0.0.0.0/0&#13;
   - gateway: 2408:8631:c02:ffa2::1  #需要修改的客户现场网关&#13;
   network: ::/0 &#13;
在cluster/etcd下添加俩配置&#13;
 ●advertisedSubnets: # listenSubnets defaults to advertisedSubnets if not set explicitly&#13;
   - 172.16.102.0/24 #和客户现场保持一致&#13;
   listenSubnets:&#13;
   - 172.16.102.0/24 #和客户现场保持一致&#13;
修改cluster/kubelet下nodeIP:&#13;
 ●nodeIP# The validSubnets field configures the networks to pick kubelet node IP from.&#13;
   validSubnets:&#13;
   - 172.16.102.0/24 #和客户现场保持一致&#13;
修改完后保存退出，看通过客户现场的地址是否能连接集群并看pod状态是否都正常。</description><guid isPermaLink="true">https://h-haonan.github.io/haonan//post/talos-xiu-gai-jie-dian-di-zhi-fang-an.html</guid><pubDate>Fri, 10 May 2024 07:07:56 +0000</pubDate></item><item><title>私有镜像库搭建</title><link>https://h-haonan.github.io/haonan//post/si-you-jing-xiang-ku-da-jian.html</link><description>Talos系统部署所需的本地仓库搭建&#13;
硬件平台：服务器&#13;
系统：Centos 7&#13;
&#13;
一、Centos安装docker&#13;
1.卸载旧的版本&#13;
&#13;
sudo yum remove docker \&#13;
docker-client \&#13;
docker-client-latest \&#13;
docker-common \&#13;
docker-latest \&#13;
docker-latest-logrotate \&#13;
docker-logrotate \&#13;
docker-engine&#13;
2.需要安装包&#13;
sudo yum install -y yum-utils&#13;
&#13;
3.设置镜像仓库&#13;
1）官方镜像：（比较慢，不推荐）&#13;
&#13;
sudo yum-config-manager \&#13;
--add-repo \&#13;
https://download.docker.com/linux/centos/docker-ce.repo&#13;
&#13;
2）阿里镜像仓库：（推荐）&#13;
sudo yum-config-manager \&#13;
--add-repo \&#13;
http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo&#13;
&#13;
4.安装 docker&#13;
1）安装前先更新yum软件包索引&#13;
yum makecache fast&#13;
&#13;
2）安装docker-ce（社区版-免费的）&#13;
sudo yum install docker-ce docker-ce-cli containerd.io&#13;
&#13;
5.启动docker&#13;
sudo systemctl start docker&#13;
&#13;
6.如何判断是否成功安装docker 查看版本&#13;
docker version&#13;
&#13;
7、启动 docker 并设置开机自启&#13;
systemctl enable --now docker&#13;
&#13;
&#13;
二、Docker的镜像加速器   （这一项可以跳过，不用设置）&#13;
1.修改docker的镜像加速器,daocloud公司推出的加速工具1.一句命令生成docker加速地址&#13;
# curl -sSL https://get.daocloud.io/daotools/set_mirror.sh | sh -s http://f1361db2.m.daocloud.io&#13;
2.修改配置文件 /etc/docker/daemon.json&#13;
改成如下配置即可(默认在最后有个逗号，去掉即可，如果没有，请忽略以下步骤)&#13;
{"registry-mirrors": ["http://f1361db2.m.daocloud.io"]}&#13;
3.重启docker&#13;
systemctl restart docker&#13;
&#13;
三、私有仓库搭建&#13;
1.执行以下命令，会启动一个registry容器，该容器用于提供私有仓库的服务&#13;
# docker run -d -p 6000:5000 --restart always --name registry-airgapped registry:2&#13;
说明：&#13;
docker run ：创建一个新的容器并运行一个命令&#13;
-d: 后台运行容器，并返回容器ID；&#13;
-p: 指定端口映射，格式为：主机(宿主)端口:容器端口；&#13;
&#13;
&#13;
&#13;
2. 查看registry容器运行状态&#13;
# docker ps&#13;
&#13;
&#13;
3.查看talos系统使用的默认镜像列表，也就是我们创建集群基础架构所需的镜像集。</description><guid isPermaLink="true">https://h-haonan.github.io/haonan//post/si-you-jing-xiang-ku-da-jian.html</guid><pubDate>Fri, 10 May 2024 06:46:24 +0000</pubDate></item><item><title>简版部署集群</title><link>https://h-haonan.github.io/haonan//post/jian-ban-bu-shu-ji-qun.html</link><description>简版&#13;
根据提供的patch文件生成talos的三个部署文件。</description><guid isPermaLink="true">https://h-haonan.github.io/haonan//post/jian-ban-bu-shu-ji-qun.html</guid><pubDate>Fri, 10 May 2024 06:44:12 +0000</pubDate></item><item><title>nginx编译</title><link>https://h-haonan.github.io/haonan//post/nginx-bian-yi.html</link><description>方法一：直接编译&#13;
 tar -zxvf nginx-1.20.2.tar.gz&#13;
ll&#13;
cd nginx-1.20.2&#13;
ll&#13;
yum install -y gcc gcc-c++ glibc make autoconf openssl openssl-devel &amp;&amp; yum install -y pcre-devel libxslt-devel gd-devel GeoIP GeoIP-devel GeoIP-data&#13;
cd ..&#13;
 yum install -y unzip zip &amp;&amp; unzip ngx_http_substitutions_filter_module-master.zip&#13;
cd nginx-1.20.2&#13;
&#13;
&#13;
./configure --prefix=/usr/local/nginx --with-file-aio --with-http_ssl_module --with-http_realip_module --with-http_addition_module --with-http_xslt_module --with-http_image_filter_module --with-http_geoip_module  --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_auth_request_module --with-http_random_index_module --with-http_secure_link_module --with-http_degradation_module --with-http_stub_status_module --add-module=/home/install/ngx_http_substitutions_filter_module-master &amp;&amp; make &amp;&amp; make install&#13;
&#13;
cd /usr/local/nginx/sbin/&#13;
./nginx&#13;
./nginx -s stop&#13;
./nginx&#13;
cd ..&#13;
cd sbin&#13;
./nginx -s reload&#13;
&#13;
ps -ef | grep nginx&#13;
方法二：通过nginx二进制包安装&#13;
需要加入/usr/local/nginx/conf/nginx.conf文件和/usr/local/nginx/logs/error.log文件&#13;
执行chmod a+x nginx最后执行./nginx&#13;
。</description><guid isPermaLink="true">https://h-haonan.github.io/haonan//post/nginx-bian-yi.html</guid><pubDate>Fri, 10 May 2024 06:42:18 +0000</pubDate></item><item><title>redmine部署</title><link>https://h-haonan.github.io/haonan//post/redmine-bu-shu.html</link><description>环境：&#13;
Centos7环境&#13;
内核版本号：4.19.94-300.el7.x86_64&#13;
1.安装系统包和部分软件包&#13;
yum -y install patch make gcc gcc-c++ gcc-g77 flex* bison file  &#13;
yum -y install libtool libtool-libs libtool-ltdl-devel* autoconf kernel-devel automake libmcrypt*  &#13;
yum -y install libjpeg libjpeg-devel libpng libpng-devel libpng10 libpng10-devel gd gd-devel  &#13;
yum -y install freetype freetype-devel libxml2 libxml2-devel zlib zlib-devel  &#13;
yum -y install glib2 glib2-devel bzip2 bzip2-devel libevent libevent-devel  &#13;
yum -y install ncurses ncurses-devel curl curl-devel e2fsprogs  &#13;
yum -y install e2fsprogs-devel krb5 krb5-devel libidn libidn-devel  &#13;
yum -y install openssl openssl-devel vim-minimal nano sendmail  &#13;
yum -y install fonts-chinese gettext gettext-devel  &#13;
yum -y install gmp-devel pspell-devel   &#13;
yum -y install readline* libxslt* pcre* net-snmp* gmp* libtidy*  &#13;
yum -y install ImageMagick* subversion*&#13;
&#13;
2.安装mysql&#13;
rpm --import https://repo.mysql.com/RPM-GPG-KEY-mysql-2022&#13;
yum install mysql-server&#13;
启动mysql服务并查看运行状态&#13;
service mysqld start&#13;
systemctl status mysqld&#13;
查看初始密码：grep 'A temporary password' /var/log/mysqld.log&#13;
登录：mysql -uroot –p&#13;
密码就是查看初始密码&#13;
然后先需要改密码，要不会有提醒&#13;
先设置长度和等级&#13;
mysql&gt; set global validate_password_policy=LOW;&#13;
mysql&gt; set global validate_password_length=6;&#13;
mysql&gt; ALTER USER USER() IDENTIFIED BY '123456';#123456为密码&#13;
创建数据库&#13;
create database redmine character set utf8;  &#13;
create user 'redmine'@'localhost' IDENTIFIED BY '123456'; #用户名: redmine; 密码:123456  &#13;
grant all privileges on redmine.* to 'redmine'@'localhost'; #最大权限  &#13;
flush privileges;&#13;
exit退出&#13;
&#13;
3.安装rvm&#13;
1.创建目录&#13;
cd /usr/local&#13;
mkdir rvm&#13;
cd rvm&#13;
command curl -sSL https://rvm.io/mpapis.asc | gpg2 --import -&#13;
command curl -sSL https://rvm.io/pkuczynski.asc | gpg2 --import -&#13;
curl -L get.rvm.io | bash -s stable&#13;
或者&#13;
1.执行curl -L get.rvm.io | bash -s stable， 一般会报错，并提示&#13;
gpg --keyserver hkp://keys.gnupg.net&#13;
–recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3&#13;
7D2BAF1CF37B13E2069D6956105BD0E739499BDB&#13;
&#13;
2.这时便获取密钥，然后执行gpg --keyserver hkp://keys.gnupg.net&#13;
–recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3&#13;
7D2BAF1CF37B13E2069D6956105BD0E739499BDB&#13;
3.执行curl -sSL https://get.rvm.io | bash -s stable&#13;
4. 查看rvm版本 rvm –v&#13;
不好用执行source /etc/profile.d/rvm.sh&#13;
&#13;
4.安装ruby&#13;
查看是否有ruby2.6版本&#13;
rvm list known&#13;
rvm install 2.6&#13;
&#13;
5.安装rails和相关依赖包&#13;
安装rails5.2&#13;
gem install rails -v 5.2  &#13;
安装rake&#13;
gem install rake  &#13;
安装mysql2&#13;
gem install mysql2  &#13;
安装activesupport&#13;
gem install activesupport -v 4.2.6&#13;
安装cocoapods&#13;
gem install cocoapods&#13;
&#13;
6.下载redmine并安装依赖&#13;
cd /home&#13;
https://www.redmine.org/projects/redmine/wiki/Download #下载地址&#13;
将下载的安装包放入home路径下解压&#13;
cd redmine-4.2.0&#13;
bundle install&#13;
&#13;
7.配置redmine并初始化&#13;
配置文件&#13;
cp config/database.yml.example config/database.yml  &#13;
选择production部分修改数据库密码&#13;
vim config/database.yml &#13;
安装mysql2&#13;
gem install mysql2&#13;
生成Rails使用的随机密钥，用于编码存储会话数据的cookie，从而防止其被篡改。</description><guid isPermaLink="true">https://h-haonan.github.io/haonan//post/redmine-bu-shu.html</guid><pubDate>Fri, 10 May 2024 06:41:37 +0000</pubDate></item><item><title>Jenkins部署</title><link>https://h-haonan.github.io/haonan//post/Jenkins-bu-shu.html</link><description>Jenkins部署&#13;
基于centos7环境，默认docker已经安装&#13;
以docker方式部署jenkins&#13;
启动安装&#13;
1.启动docker，下载Jenkins镜像文件&#13;
docker pull jenkins/jenkins&#13;
 2.创建Jenkins挂载目录并授权权限&#13;
（我们在服务器上先创建一个jenkins工作目录 /var/jenkins_mount，赋予相应权限，稍后我们将jenkins容器目录挂载到这个目录上，这样我们就可以很方便地对容器内的配置文件进行修改。</description><guid isPermaLink="true">https://h-haonan.github.io/haonan//post/Jenkins-bu-shu.html</guid><pubDate>Fri, 10 May 2024 06:40:17 +0000</pubDate></item><item><title>helm转yaml方法</title><link>https://h-haonan.github.io/haonan//post/helm-zhuan-yaml-fang-fa.html</link><description>#1.首先需要一个http服务器，通过docker或者在centos上直接yum install 部署都可以&#13;
docker run -d -p 8081:80 -v /var/www:/usr/local/apache2/htdocs httpd&#13;
这个docker命令会创建并运行一个httpd容器,参数说明如下:&#13;
- `-d`: 后台运行容器&#13;
- `-p 8081:80`: 映射容器内80端口到宿主机8081端口&#13;
- `-v /var/www:/usr/local/apache2/htdocs`: 把宿主机/var/www目录挂载到容器的/usr/local/apache2/htdocs,作为网页文档根目录&#13;
- `httpd`: 使用httpd镜像启动容器&#13;
这样就在宿主机8081端口启动了一个httpd服务器,网页文档来自宿主机的/var/www目录。</description><guid isPermaLink="true">https://h-haonan.github.io/haonan//post/helm-zhuan-yaml-fang-fa.html</guid><pubDate>Fri, 10 May 2024 06:37:02 +0000</pubDate></item><item><title>PXE系统部署</title><link>https://h-haonan.github.io/haonan//post/PXE-xi-tong-bu-shu.html</link><description>PXE系统部署&#13;
✧ 使用http用来发布linux系统的安装树（也可以使用NFS、FTP server或HTTPS）&#13;
✧ DHCP server为客户端分配ip并提供TFTP服务器地址及PXE启动文件位置&#13;
✧ TFTP server为客户端提供引导文件。</description><guid isPermaLink="true">https://h-haonan.github.io/haonan//post/PXE-xi-tong-bu-shu.html</guid><pubDate>Fri, 10 May 2024 06:25:15 +0000</pubDate></item><item><title>rancher高可用安装（基于k8s集群基础上通过helm安装）</title><link>https://h-haonan.github.io/haonan//post/rancher-gao-ke-yong-an-zhuang-%EF%BC%88-ji-yu-k8s-ji-qun-ji-chu-shang-tong-guo-helm-an-zhuang-%EF%BC%89.html</link><description>k8s集群安装部署（先决条件）&#13;
一. 添加 Helm Chart 仓库&#13;
请将命令中的&lt;CHART_REPO&gt;，替换为latest，stable或alpha。</description><guid isPermaLink="true">https://h-haonan.github.io/haonan//post/rancher-gao-ke-yong-an-zhuang-%EF%BC%88-ji-yu-k8s-ji-qun-ji-chu-shang-tong-guo-helm-an-zhuang-%EF%BC%89.html</guid><pubDate>Mon, 29 Apr 2024 01:08:57 +0000</pubDate></item><item><title>安装部署keepalived</title><link>https://h-haonan.github.io/haonan//post/an-zhuang-bu-shu-keepalived.html</link><description>1. 安装部署keepalived（Master和Slave两机器同样操作）&#13;
1）安装keepalived&#13;
# yum -y install keepalived&#13;
&#13;
2）Master节点的keepalived.conf配置&#13;
这里特别需要注意：&#13;
一定要设置keepalived为非抢占模式，如果设置成抢占模式会在不断的切换主备时容易造成NFS数据丢失。</description><guid isPermaLink="true">https://h-haonan.github.io/haonan//post/an-zhuang-bu-shu-keepalived.html</guid><pubDate>Mon, 01 Apr 2024 09:11:16 +0000</pubDate></item><item><title>镜像本地打包发往没有网的服务器</title><link>https://h-haonan.github.io/haonan//post/jing-xiang-ben-di-da-bao-fa-wang-mei-you-wang-de-fu-wu-qi.html</link><description>使用 docker pull 拉取镜像的时候需要网络，但是项目部署一般都是在内网。</description><guid isPermaLink="true">https://h-haonan.github.io/haonan//post/jing-xiang-ben-di-da-bao-fa-wang-mei-you-wang-de-fu-wu-qi.html</guid><pubDate>Mon, 01 Apr 2024 09:02:09 +0000</pubDate></item><item><title>那些我必安装的Awesome Windows App推荐。</title><link>https://h-haonan.github.io/haonan//post/na-xie-wo-bi-an-zhuang-de-Awesome%20Windows%20App-tui-jian-%E3%80%82.html</link><description>🗃️ [7-Zip](http://www.7-zip.org/) - 用于处理压缩包的开源Windows实用程序&#13;
🖼️ [Snipaste](https://snipaste.com/) - 高效率、功能全面的截图软件&#13;
🖼️ [ScreenToGif](http://www.screentogif.com/) - 它允许你录制屏幕的一部分区域并保存为 gif 或视频&#13;
✏️ [Visual Studio Code](https://code.visualstudio.com/) - 宇宙最强文本编辑器&#13;
📝 [PDFgear](https://www.pdfgear.com/) - 免费的PDF查看&amp;编辑器&#13;
📝 [PDF24](https://tools.pdf24.org/) - 免费的在线PDF查看&amp;编辑器&#13;
📽️ [PotPlayer](http://potplayer.daum.net/) - 多媒体播放器，具有广泛的编解码器集合&#13;
🟢 [GEEK UNINSTALLER](https://geekuninstaller.com/) - 好用的软件卸载工具&#13;
🔍 [Everything](http://www.voidtools.com/) - 最快的文件/文件夹搜索工具， 通过名称搜索&#13;
⌨️ [MobaXterm](http://mobaxterm.mobatek.net/) - Xserver 和标签式 SSH 客户端&#13;
⌨️ [Tera Term](https://teratermproject.github.io/index-en.html) - 好用的串口调试助手&#13;
🖥️ [CPU-Z](http://www.cpuid.com/softwares/cpu-z.html) - 免费且功能齐全的 CPU 监控工具&#13;
🖥️ [GPU-Z](http://www.techpowerup.com/gpuz/) - 免费且功能齐全的 GPU 监控工具&#13;
💾 [DiskGenius](https://www.diskgenius.cn/) - 老牌国产软件，专注数据恢复与磁盘管理，中文界面。</description><guid isPermaLink="true">https://h-haonan.github.io/haonan//post/na-xie-wo-bi-an-zhuang-de-Awesome%20Windows%20App-tui-jian-%E3%80%82.html</guid><pubDate>Mon, 01 Apr 2024 08:42:06 +0000</pubDate></item></channel></rss>